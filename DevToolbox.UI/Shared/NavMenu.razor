@inject NavigationManager NavigationManager
@implements IDisposable

<nav class="nav-container">
    <div class="nav-logo">
        <a href="/">DevToolbox</a>
    </div>
    
    <div class="nav-links">
        <div class="nav-item @GetActiveClass("/")">
            <a href="/">Home</a>
        </div>
        <div class="nav-item @GetActiveClass("/workspaces")">
            <a href="/workspaces">Workspaces</a>
        </div>
        <div class="nav-item @GetActiveClass("/logs")">
            <a href="/logs">Log Viewer</a>
        </div>
        <div class="nav-item @GetActiveClass("/powershell")">
            <a href="/powershell">PowerShell</a>
        </div>
        <div class="nav-item @GetActiveClass("/settings")">
            <a href="/settings">Settings</a>
        </div>
    </div>
    
    <DarkModeToggle />
</nav>

@code {
    protected override void OnInitialized()
    {
        NavigationManager.LocationChanged += LocationChanged;
        base.OnInitialized();
    }

    private void LocationChanged(object? sender, LocationChangedEventArgs e)
    {
        // Force the component to re-render when navigation occurs
        StateHasChanged();
    }

    private string GetActiveClass(string route)
    {
        var currentPath = "/" + NavigationManager.ToBaseRelativePath(NavigationManager.Uri).TrimEnd('/');
        
        // Special case for root
        if (currentPath == "/" && route == "/")
            return "active";
            
        // For exact matches
        if (currentPath == route)
            return "active";
            
        // Not active
        return "";
    }
    
    public void Dispose()
    {
        // Unsubscribe from the event when the component is disposed
        NavigationManager.LocationChanged -= LocationChanged;
    }
} 